<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Valore Ora Pro</title>
    
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2611/2611139.png">
    <link rel="manifest" href="data:application/manifest+json,{%22name%22:%22ValoreOra%22,%22short_name%22:%22ValoreOra%22,%22display%22:%22standalone%22,%22background_color%22:%22%23ffffff%22,%22theme_color%22:%22%230f172a%22}">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white !important; padding: 0 !important; }
            #resultCard { 
                background: white !important; 
                color: black !important; 
                border: 2px solid black !important; 
                border-radius: 1.5rem !important;
                box-shadow: none !important;
            }
            #progressBarContainer { border: 1px solid black !important; }
            #progressBar { background: black !important; }
            .pdf-details-card {
                border: 2px solid black !important;
                border-radius: 1.5rem !important;
                padding: 2rem !important;
            }
            .title-line { border-bottom: 2px solid black !important; padding-bottom: 8px; margin-bottom: 15px; }
            .stats-footer {
                border: 1px solid #e2e8f0 !important;
                display: grid !important;
                grid-template-columns: 1fr auto 1fr !important;
                background: white !important;
                color: black !important;
            }
            .v-line { background: black !important; width: 2px !important; height: 40px !important; display: block !important; margin: 0 auto; }
        }
        .print-only { display: none; }
        .v-line { display: none; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen text-slate-800 pb-10">

    <div class="max-w-xl mx-auto p-4 space-y-4">
        
        <header class="bg-white p-6 rounded-[2.5rem] shadow-sm border border-slate-200 flex justify-between items-center no-print">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-slate-900 rounded-2xl flex items-center justify-center shadow-lg text-white font-black">‚Ç¨</div>
                <h1 class="text-lg font-black leading-none uppercase">Report Valore Ora</h1>
            </div>
            <div class="bg-blue-50 px-3 py-2 rounded-2xl border border-blue-100 flex items-center gap-1">
                <input type="number" id="baseBenchmark" value="20.84" step="0.01" class="w-14 font-black text-blue-600 bg-transparent text-right outline-none" oninput="calculate()">
                <span class="text-[8px] font-black text-blue-400 uppercase">Target</span>
            </div>
        </header>

        <div class="bg-white p-6 rounded-[2.5rem] shadow-sm border border-slate-200 space-y-4 no-print">
            <h3 class="text-[11px] font-[900] uppercase tracking-widest text-slate-400 italic flex items-center gap-2">
                <span class="w-2 h-2 bg-emerald-500 rounded-full"></span> Bilancio Economico
            </h3>
            <div class="space-y-3">
                <div>
                    <label class="text-[9px] font-bold text-slate-400 uppercase ml-1">Stipendio Netto Annuo</label>
                    <input type="number" id="stipendio" value="18250" class="w-full p-4 bg-slate-50 border-none rounded-2xl font-black text-lg text-emerald-700 shadow-inner outline-none" oninput="calculate()">
                </div>
                <div>
                    <label class="text-[9px] font-bold text-emerald-600 uppercase ml-1">Buoni Pasto (‚Ç¨/giorno)</label>
                    <input type="number" id="buoniPasto" value="0" step="0.5" class="w-full p-4 bg-emerald-50 border-none rounded-2xl font-bold shadow-inner outline-none text-emerald-700" oninput="calculate()">
                </div>
                <div>
                    <label class="text-[9px] font-bold text-rose-500 uppercase ml-1">Spese (‚Ç¨/mese)</label>
                    <input type="number" id="speseMese" value="100" class="w-full p-4 bg-rose-50 border-none rounded-2xl font-bold text-rose-600 shadow-inner outline-none" oninput="calculate()">
                    <input type="range" id="mesiSpesa" min="1" max="12" value="10" class="w-full mt-2 accent-rose-500" oninput="calculate()">
                    <p class="text-[9px] text-right font-bold text-slate-400"><span id="valMesiSpesa">10</span> mesi spese/anno</p>
                </div>
            </div>
        </div>

        <div class="bg-white p-6 rounded-[2.5rem] shadow-sm border border-slate-200 space-y-4 no-print">
            <h3 class="text-[11px] font-[900] uppercase tracking-widest text-slate-400 italic flex items-center gap-2">
                <span class="w-2 h-2 bg-blue-500 rounded-full"></span> Parametri Tempo
            </h3>
            <div class="space-y-3">
                <div>
                    <div class="flex justify-between items-center mb-1 px-1">
                        <label class="text-[9px] font-bold text-slate-400 uppercase">Impegno Lavorativo</label>
                        <select id="oreMode" class="bg-blue-50 text-[9px] font-black uppercase px-2 py-1 rounded-lg text-blue-600 outline-none border border-blue-100" onchange="toggleOreMode()">
                            <option value="ore">Ore Sett.</option>
                            <option value="perc">% Part-time</option>
                        </select>
                    </div>
                    <input type="number" id="oreInput" value="17.25" step="0.01" class="w-full p-4 bg-slate-50 border-none rounded-2xl font-black shadow-inner outline-none text-blue-700" oninput="calculate()">
                </div>
                <div>
                    <label class="text-[9px] font-bold text-slate-400 uppercase ml-1">Ciclo Settimane</label>
                    <div class="flex gap-2">
                        <select id="settimanePreset" class="flex-1 p-4 bg-slate-50 rounded-2xl text-[10px] font-black outline-none border border-slate-100" onchange="handleWeeks()">
                            <option value="43">Scuola (43 sett.)</option>
                            <option value="48">Standard (48 sett.)</option>
                            <option value="custom">Manuale...</option>
                        </select>
                        <input type="number" id="settimane" value="43" class="w-20 p-4 bg-blue-50 rounded-2xl font-black text-center text-xs outline-none hidden border-2 border-blue-200" oninput="calculate()">
                    </div>
                </div>
                <div>
                    <label class="text-[9px] font-bold text-slate-400 uppercase ml-1">Viaggio A/R (minuti/giorno)</label>
                    <input type="number" id="viaggio" value="24" class="w-full p-4 bg-slate-50 border-none rounded-2xl font-bold shadow-inner outline-none" oninput="calculate()">
                </div>
            </div>
        </div>

        <div id="resultCard" class="p-10 rounded-[3rem] shadow-2xl text-white text-center transition-all relative overflow-hidden">
            <p class="text-[10px] font-bold uppercase tracking-widest mb-1 opacity-70">Valore Orario Reale</p>
            <div id="valoreOrario" class="text-7xl font-[900] mb-4 tracking-tighter italic">0,00 ‚Ç¨</div>
            <div id="feedback" class="inline-block px-6 py-2 rounded-full bg-white/20 text-[10px] font-black uppercase tracking-widest mb-6 shadow-sm">Analisi...</div>
            
            <div class="mt-4 space-y-2 text-left">
                <div class="flex justify-between text-[10px] font-bold uppercase"><span>Efficienza</span><span id="percVal">0%</span></div>
                <div id="progressBarContainer" class="w-full bg-black/10 h-3 rounded-full overflow-hidden border border-white/10">
                    <div id="progressBar" class="h-full bg-white transition-all shadow-[0_0_15px_white]" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div class="print-only pdf-details-card bg-white">
            <h3 class="title-line font-[900] italic uppercase text-xl">Analisi Professionale del Tempo</h3>
            <div class="grid grid-cols-2 gap-y-4 text-sm mt-4">
                <div><span class="text-slate-400 font-bold">Stipendio Netto:</span> <b id="pdf-netto"></b></div>
                <div><span class="text-slate-400 font-bold">Buoni Pasto:</span> <b id="pdf-bp"></b></div>
                <div><span class="text-slate-400 font-bold">Spese Annuali:</span> <b id="pdf-spese"></b></div>
                <div><span class="text-slate-400 font-bold">Benchmark:</span> <b id="pdf-bench"></b></div>
            </div>
            <hr class="my-6 border-slate-100">
            <div class="text-[13px] font-bold uppercase">
                <span class="text-slate-400 mr-2">Carico Temporale:</span> 
                <span id="pdf-carico" class="text-slate-900"></span>
            </div>
        </div>

        <div class="stats-footer bg-slate-900 p-8 rounded-[3rem] text-white grid grid-cols-[1fr_auto_1fr] items-center shadow-2xl">
            <div class="pr-4">
                <p class="text-[9px] font-black text-emerald-400 uppercase mb-1">Reddito Reale</p>
                <div id="redditoPulitoDisplay" class="text-3xl font-black italic">0 ‚Ç¨</div>
                <p id="bpDetail" class="text-[9px] font-bold text-slate-500 uppercase mt-1">+0‚Ç¨ BUONI PASTO</p>
            </div>
            <div class="v-line"></div>
            <div class="text-right pl-4">
                <p class="text-[9px] font-black text-blue-400 uppercase mb-1">Vita Sequestrata</p>
                <div id="oreTotali" class="text-3xl font-black text-blue-500 italic">0 h</div>
                <p id="infoSett" class="text-[9px] font-bold text-slate-500 uppercase mt-1">0 ORE/SETTIMANA</p>
            </div>
        </div>

        <button onclick="window.print()" class="w-full bg-slate-900 text-white font-black py-5 rounded-[2.5rem] shadow-xl active:scale-95 transition-all text-xs uppercase tracking-widest no-print">
            üíæ Esporta Report PDF
        </button>
    </div>

    <script>
        function handleWeeks() {
            const preset = document.getElementById('settimanePreset').value;
            const customInput = document.getElementById('settimane');
            if (preset === 'custom') { customInput.classList.remove('hidden'); } 
            else { customInput.classList.add('hidden'); customInput.value = preset; }
            calculate();
        }

        function toggleOreMode() {
            const mode = document.getElementById('oreMode').value;
            const input = document.getElementById('oreInput');
            let v = parseFloat(input.value) || 0;
            // Converte tra ore (basato su 40h) e percentuale
            input.value = mode === 'perc' ? ((v / 40) * 100).toFixed(2) : ((v * 40) / 100).toFixed(2);
            calculate();
        }

        function calculate() {
            const bench = parseFloat(document.getElementById('baseBenchmark').value) || 0;
            const stip = parseFloat(document.getElementById('stipendio').value) || 0;
            const bp = parseFloat(document.getElementById('buoniPasto').value) || 0;
            const oMode = document.getElementById('oreMode').value;
            const oIn = parseFloat(document.getElementById('oreInput').value) || 0;
            const sett = parseInt(document.getElementById('settimane').value) || 0;
            const speseM = parseFloat(document.getElementById('speseMese').value) || 0;
            const mesiS = parseInt(document.getElementById('mesiSpesa').value);
            const viaggMin = parseFloat(document.getElementById('viaggio').value) || 0;

            const oreSett = oMode === 'perc' ? (oIn * 40 / 100) : oIn;
            const bpTot = bp * (sett * 5);
            const speseTot = speseM * mesiS;
            const nettoF = (stip + bpTot) - speseTot;
            const oreLavA = oreSett * sett;
            const oreViaggA = (viaggMin * 5 * sett) / 60;
            const oreTot = oreLavA + oreViaggA;
            const pagaR = oreTot > 0 ? nettoF / oreTot : 0;

            document.getElementById('valMesiSpesa').innerText = mesiS;
            document.getElementById('valoreOrario').innerText = pagaR.toFixed(2) + ' ‚Ç¨';
            document.getElementById('redditoPulitoDisplay').innerText = Math.round(nettoF).toLocaleString() + ' ‚Ç¨';
            document.getElementById('oreTotali').innerText = Math.round(oreTot) + ' h';
            document.getElementById('infoSett').innerText = `${oreSett.toFixed(2)} ORE/SETTIMANA`;
            document.getElementById('bpDetail').innerText = `+${Math.round(bpTot)}‚Ç¨ BUONI PASTO`;

            const perc = Math.min((pagaR / bench) * 100, 100);
            document.getElementById('progressBar').style.width = perc + '%';
            document.getElementById('percVal').innerText = Math.round((pagaR / bench) * 100) + '%';

            document.getElementById('pdf-netto').innerText = stip.toLocaleString() + ' ‚Ç¨';
            document.getElementById('pdf-bp').innerText = Math.round(bpTot) + ' ‚Ç¨';
            document.getElementById('pdf-spese').innerText = '-' + speseTot.toLocaleString() + ' ‚Ç¨';
            document.getElementById('pdf-bench').innerText = bench.toFixed(2) + ' ‚Ç¨/h';
            document.getElementById('pdf-carico').innerText = `${Math.round(oreLavA)} h lavorative + ${Math.round(oreViaggA)} h viaggio`;

            const card = document.getElementById('resultCard');
            const feed = document.getElementById('feedback');
            if (pagaR >= bench) {
                card.className = "p-10 rounded-[3rem] shadow-2xl text-white text-center transition-all bg-emerald-500";
                feed.innerText = "‚≠ê UPGRADE VALORE";
            } else if (pagaR >= bench * 0.9) {
                card.className = "p-10 rounded-[3rem] shadow-2xl text-white text-center transition-all bg-amber-500";
                feed.innerText = "‚ö†Ô∏è VALORE IN CALO";
            } else {
                card.className = "p-10 rounded-[3rem] shadow-2xl text-white text-center transition-all bg-rose-500";
                feed.innerText = "‚ùå SVALUTAZIONE ORA";
            }
        }
        window.onload = calculate;
    </script>
</body>
</html>
